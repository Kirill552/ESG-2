# ESG-2 Backend - –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ backend –º–æ–¥—É–ª—è

```
ESG-2/backend/
‚îú‚îÄ‚îÄ lib/                          # –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ parsers/                  # –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base-parser.ts        # –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ csv-parser.ts         # CSV –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ excel-parser.ts       # Excel (.xls/.xlsx) –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ html-parser.ts        # HTML –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ json-parser.ts        # JSON –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ office-parser.ts      # Office –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdf-parser.ts         # PDF –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rtf-parser.ts         # RTF –ø–∞—Ä—Å–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ txt-parser.ts         # –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts              # –≠–∫—Å–ø–æ—Ä—Ç—ã –ø–∞—Ä—Å–µ—Ä–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ multi-level-ocr-service.ts        # üî• –ì–ª–∞–≤–Ω—ã–π OCR –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ yandex-vision-service.ts          # Yandex Vision API
‚îÇ   ‚îú‚îÄ‚îÄ yandex-iam-token-manager.ts       # IAM —Ç–æ–∫–µ–Ω—ã –¥–ª—è Yandex
‚îÇ   ‚îú‚îÄ‚îÄ ocr.ts                           # Tesseract OCR fallback
‚îÇ   ‚îú‚îÄ‚îÄ s3.ts                            # Yandex Object Storage
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ foundation-models-client.ts       # Cloud.ru Foundation Models
‚îÇ   ‚îú‚îÄ‚îÄ enhanced-extraction-service.ts    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ESG –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ intelligent-file-processor.ts     # –£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ simplified-ocr-service.ts         # –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π OCR
‚îÇ   ‚îú‚îÄ‚îÄ contextual-analysis-service.ts    # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ format-detector.ts               # –î–µ—Ç–µ–∫—Ç–æ—Ä —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ synonym-dictionary.ts            # –°–ª–æ–≤–∞—Ä—å —Å–∏–Ω–æ–Ω–∏–º–æ–≤ –¥–ª—è –≠–°–ì
‚îÇ   ‚îú‚îÄ‚îÄ russian-document-patterns.ts     # –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ supported-file-types.ts          # –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ text-utils.ts                    # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ logger.ts                        # –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ structured-logger.ts             # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts                         # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
```

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ OCR —Å–∏—Å—Ç–µ–º—ã

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
1. **Yandex Vision API** (–æ—Å–Ω–æ–≤–Ω–æ–π) ‚Äî –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è —Å–∫–∞–Ω–æ–≤
2. **Tesseract OCR** (fallback) ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
3. **Foundation Models** (–ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞) ‚Äî –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã
- **CSV/Excel**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–± —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏
- **PDF**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—á–µ—Ç–æ–≤ –∏ —Å–ø—Ä–∞–≤–æ–∫
- **Office**: Word/PowerPoint –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **HTML/JSON**: –í–µ–±-–¥–∞–Ω–Ω—ã–µ –∏ API –æ—Ç–≤–µ—Ç—ã

## üß† Foundation Models Integration

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏ (Cloud.ru):
- **GigaChat 2-Max** ‚Äî –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- **Llama-3.3-70B** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å 
- **GLM-4.5** ‚Äî –∫–∏—Ç–∞–π—Å–∫–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞
- **GPT-OSS-120B** ‚Äî open source –º–æ–¥–µ–ª—å

### –§—É–Ω–∫—Ü–∏–∏ –ò–ò:
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–∫–∞–Ω–æ–≤
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è  
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ OCR

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

### EnhancedExtractionService
```typescript
// –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ESG –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
const extractor = new EnhancedExtractionService();
const result = await extractor.extractFromDocument(buffer, filename);
```

### MultiLevelOcrService  
```typescript
// –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è OCR –æ–±—Ä–∞–±–æ—Ç–∫–∞
const ocr = new MultiLevelOcrService();
const text = await ocr.processFile(buffer, filename);
```

### IntelligentFileProcessor
```typescript
// –£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Ç–∏–ø–∞
const processor = new IntelligentFileProcessor();
const data = await processor.processFile(fileBuffer, mimeType);
```

## üîß –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
```json
{
  "tesseract.js": "^6.0.1",
  "exceljs": "^4.4.0", 
  "@aws-sdk/client-s3": "^3.540.0",
  "pdf-parse": "^1.1.1",
  "sharp": "^0.33.0",
  "node-jose": "^2.2.0"
}
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **Node.js 18+**
- **Yandex Cloud** –∞–∫–∫–∞—É–Ω—Ç (Vision API + Object Storage)
- **Cloud.ru** –∞–∫–∫–∞—É–Ω—Ç (Foundation Models API)

## üåç –†–æ—Å—Å–∏–π—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã:
- –ö–æ–¥–∏—Ä–æ–≤–∫–∏: UTF-8, CP1251, CP866
- –†–æ—Å—Å–∏–π—Å–∫–∏–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è (–∫–í—Ç¬∑—á, –ì–∫–∞–ª, –º¬≥)
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º:
- **296-–§–ó** ‚Äî —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É–≥–ª–µ—Ä–æ–¥–Ω–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- **CBAM** ‚Äî –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã —Ç—Ä–∞–Ω—Å–≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ —É–≥–ª–µ—Ä–æ–¥–Ω–æ–≥–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –£–ø—Ä–æ—â–µ–Ω–∏—è –≤ ESG-2

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, ESG-2 —Å–æ–¥–µ—Ä–∂–∏—Ç:
- ‚úÖ –ü–æ–ª–Ω—É—é OCR –ª–æ–≥–∏–∫—É –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –í—Å–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã
- ‚úÖ Foundation Models –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
- ‚úÖ –†–æ—Å—Å–∏–π—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚ùå –°–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–∞—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É–±—Ä–∞–Ω–∞
- ‚ùå –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É–ø—Ä–æ—â–µ–Ω–∞
- ‚ùå –ü–ª–∞—Ç–µ–∂–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** ‚Äî —Å–æ–∑–¥–∞—Ç—å package.json
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ENV** ‚Äî –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É OCR —Å–∏—Å—Ç–µ–º—ã
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É
5. **–î–µ–ø–ª–æ–π** ‚Äî —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å

---

*–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ ESG-Lite MVP 22 —Å–µ–Ω—Ç—è–±—Ä—è 2025*